library("tidyverse")
library("janitor")
library("naniar")
sharks <- read_csv("data/SharkIncidents_1950_2022_220302.csv") %>% clean_names()
sharks
miss_var_summary(sharks)
sharks %>%
filter(incident_num!="NOT COUNTED")
sharks <- sharks %>%
filter(incident_num!="NOT COUNTED")
sharks %>%
count(incident_num)
sharks %>%
group_by(county)
sharks %>%
group_by(county) %>%
count(incident_num)
sharks %>%
count(incident_num)
sharks %>%
count(county)
sharks %>%
count(county) %>%
arrange(-n)
sharks %>%
count(county) %>%
ggplot(aes(x=county, y=n))+
geom_col()
sharks %>%
count(county) %>%
ggplot(aes(x=county, y=n))+
geom_col()+
coord_flip()
sharks %>%
count(county) %>%
ggplot(aes(x=county, y=n, fill=country))+
geom_col()+
coord_flip()
sharks %>%
count(county) %>%
ggplot(aes(x=county, y=n, fill=county))+
geom_col()+
coord_flip()
sharks %>%
count(months)
sharks %>%
count(month)
sharks %>%
count(month) %>%
ggplot(aes(x=month))+
geom_bar()
sharks %>%
count(month) %>%
ggplot(aes(x=month))+
geom_col()
sharks %>%
count(month) %>%
ggplot(aes(x=month, y=n))+
geom_col()
library("tidyverse")
library("janitor")
library("naniar")
sharks <- read_csv("data/SharkIncidents_1950_2022_220302.csv") %>% clean_names()
sharks
miss_var_summary(sharks)
sharks <- sharks %>%
filter(incident_num!="NOT COUNTED")
sharks %>%
count(county) %>%
arrange(-n)
sharks %>%
count(county) %>%
ggplot(aes(x=county, y=n, fill=county))+
geom_col()+
coord_flip()
sharks %>%
count(month) %>%
ggplot(aes(x=month, y=n))+
geom_col()
sharks %>%
count(month)
sharks %>%
count(month) %>%
arrange(-n)
sharks %>%
group_by(county)
sharks %>%
group_by(county) %>%
count(injury)
sharks %>%
group_by(county) %>%
count(injury) %>%
summarize(tot_injury=sum(injury))
sharks %>%
group_by(county) %>%
summarize(tot_injury=sum(injury))
sharks %>%
group_by(county) %>%
count(injury)
sharks %>%
group_by(county) %>%
count(injury) %>%
arrange(-n)
sharks %>%
filter(injury=="none") %>%
group_by(county) %>%
count(injury) %>%
arrange(-n)
sharks %>%
filter(injury!="none") %>%
group_by(county) %>%
count(injury) %>%
arrange(-n)
sharks %>%
filter(injury!="none") %>%
group_by(county, injury) %>%
count(injury) %>%
arrange(-n)
sharks %>%
filter(injury!="none") %>%
group_by(county, injury, .groups="keep") %>%
count(injury) %>%
arrange(-n)
sharks %>%
filter(injury!="none") %>%
group_by(county, injury) %>%
count(injury) %>%
arrange(-n)
sharks %>%
filter(injury!="none") %>%
group_by(county, injury) %>%
count(injury, .groups="keep") %>%
arrange(-n)
sharks %>%
filter(injury!="none") %>%
group_by(county, injury) %>%
count(injury) %>%
arrange(-n)
sharks %>%
filter(injury!="none") %>%
group_by(injury) %>%
count(injury) %>%
arrange(-n)
sharks %>%
filter(injury!="none") %>%
group_by(county) %>%
count(injury) %>%
arrange(-n)
sharks %>%
filter(injury!="none") %>%
group_by(county) %>%
summarize(tot_injur=sum(n), .groups = "keep") %>%
arrange(-n)
sharks %>%
filter(injury!="none") %>%
group_by(county) %>%
summarize(tot_injur=sum(injury), .groups = "keep") %>%
arrange(-n)
sharks %>%
filter(injury!="none") %>%
group_by(county) %>%
summarize(tot_injur=sum(injury), .groups = "keep")
sharks %>%
filter(injury!="none") %>%
group_by(county) %>%
summarize(tot_injur=sum(injury))
sharks %>%
filter(injury!="none") %>%
group_by(county)
sharks %>%
filter(injury!="none") %>%
group_by(county) %>%
count(injury)
sharks %>%
filter(injury!="none") %>%
count(injury)
sharks %>%
filter(injury!="none") %>%
group_by(county) %>%
count(injury)
sharks %>%
filter(injury!="none") %>%
group_by(county) %>%
count(injury) %>%
arrange(-n)
sharks %>%
filter(injury!="none") %>%
group_by(county) %>%
count(injury) %>%
summarize(tot_inj=sum(n)) %>%
arrange(-n)
sharks %>%
filter(injury!="none") %>%
group_by(county) %>%
count(injury) %>%
summarize(tot_inj=sum(n))
sharks %>%
filter(injury!="none") %>%
group_by(county) %>%
count(injury) %>%
summarize(tot_inj=sum(n)) %>%
arrange(-tot_inj)
sharks %>%
filter(injury!="none") %>%
group_by(county) %>%
count(injury) %>%
summarize(tot_inj=sum(n)) %>%
ggplot(aes(x=county, y=tot_inj))+
geom_bar()
sharks %>%
filter(injury!="none") %>%
group_by(county) %>%
count(injury) %>%
summarize(tot_inj=sum(n)) %>%
ggplot(aes(x=county, y=tot_inj))+
geom_col()
sharks %>%
filter(injury!="none") %>%
group_by(county) %>%
count(injury) %>%
summarize(tot_inj=sum(n)) %>%
ggplot(aes(x=county, y=tot_inj))+
geom_col()+
coord_flip()
sharks %>%
filter(injury!="none") %>%
group_by(county) %>%
count(injury) %>%
summarize(tot_inj=sum(n)) %>%
ggplot(aes(x=county, y=tot_inj))+
geom_col()+
coord_flip()+
labs(title = "Total Number of Incidents by County",
x="County",
y="Total Injuries")
sharks %>%
count(month) %>%
ggplot(aes(x=month, y=n))+
geom_col()+
labs(title = "Number of Incidents vs. County",
x="Month",
y="Number of Incidents")
sharks %>%
count(month) %>%
ggplot(aes(x=month, y=n))+
geom_col()+
labs(title = "Number of Incidents vs. County",
x="Month",
y="Number of Incidents")+
theme(plot.title = element_text(size=rel(1.5), hjust=0.5))
sharks %>%
count(county) %>%
ggplot(aes(x=county, y=n, fill=county))+
geom_col()+
coord_flip()+
labs(title="County vs. Number of incidents",
x="County Names",
y="Number of incidents")
sharks %>%
count(county) %>%
ggplot(aes(x=county, y=n, fill=county))+
geom_col()+
coord_flip()+
labs(title="County vs. Number of incidents",
x="County Names",
y="Number of incidents")+
theme(plot.title = element_text(size=rel(1.5), hjust=0.5))
sharks %>%
count(month) %>%
ggplot(aes(x=month, y=n))+
geom_col()+
labs(title = "Number of Incidents vs. Month",
x="Month",
y="Number of Incidents")+
theme(plot.title = element_text(size=rel(1.5), hjust=0.5))
sharks %>%
filter(injury!="none") %>%
group_by(county) %>%
count(injury) %>%
summarize(tot_inj=sum(n)) %>%
ggplot(aes(x=county, y=tot_inj))+
geom_col()+
coord_flip()+
labs(title = "Total Number of Incidents by County",
x="County",
y="Total Injuries")+
theme(plot.title = element_text(size=rel(1.5), hjust=0.5))
sharks %>%
count(mode)
sharks %>%
count(mode) %>%
arrange(-n)
sharks %>%
count(mode) %>%
ggplot(aes(x=mode, y=n))+
geom_col()
sharks %>%
count(mode) %>%
ggplot(aes(x=mode, y=n))+
geom_col()+
coord_flip()
sharks %>%
count(mode) %>%
ggplot(aes(x=mode, y=n))+
geom_col()+
coord_flip()+
labs(title = "Number of Incidents vs. Activity",
x="Activity",
y="Number of Incidents")+
theme(plot.title = element_text(size=rel(1.5), hjust=0.5))
sharks %>%
filter(injury!="none") %>%
group_by(county) %>%
count(injury) %>%
summarize(tot_inj=sum(n)) %>%
ggplot(aes(x=county, y=tot_inj, fill=injury))+
geom_col()+
coord_flip()+
labs(title = "Total Number of Incidents by County",
x="County",
y="Total Injuries")+
theme(plot.title = element_text(size=rel(1.5), hjust=0.5))
sharks %>%
filter(injury!="none") %>%
group_by(county) %>%
count(injury) %>%
summarize(tot_inj=sum(n)) %>%
ggplot(aes(x=county, y=tot_inj, group=injury))+
geom_col()+
coord_flip()+
labs(title = "Total Number of Incidents by County",
x="County",
y="Total Injuries")+
theme(plot.title = element_text(size=rel(1.5), hjust=0.5))
sharks %>%
filter(injury!="none") %>%
group_by(county) %>%
count(injury) %>%
summarize(tot_inj=sum(n)) %>%
ggplot(aes(x=county, y=tot_inj, fill=injury))+
geom_col()+
coord_flip()+
labs(title = "Total Number of Incidents by County",
x="County",
y="Total Injuries")+
theme(plot.title = element_text(size=rel(1.5), hjust=0.5))
sharks %>%
filter(injury!="none") %>%
group_by(county) %>%
count(injury) %>%
summarize(tot_inj=sum(n)) %>%
ggplot(aes(x=county, y=tot_inj))+
geom_col()+
coord_flip()+
labs(title = "Total Number of Incidents by County",
x="County",
y="Total Injuries")+
theme(plot.title = element_text(size=rel(1.5), hjust=0.5))
sharks %>%
filter(injury!="none") %>%
group_by(county) %>%
count(injury) %>%
summarize(tot_inj=sum(n)) %>%
ggplot(aes(x=county, y=tot_inj))+
geom_col(position = "dodge")+
coord_flip()+
labs(title = "Total Number of Incidents by County",
x="County",
y="Total Injuries")+
theme(plot.title = element_text(size=rel(1.5), hjust=0.5))
sharks %>%
filter(injury!="none") %>%
group_by(county) %>%
count(injury) %>%
summarize(tot_inj=sum(n)) %>%
ggplot(aes(x=county, y=tot_inj))+
geom_col(position = "dodge")+
coord_flip()+
labs(title = "Total Number of Incidents by County",
x="County",
y="Total Injuries")+
theme(plot.title = element_text(size=rel(1.5), hjust=0.5))
sharks %>%
filter(injury!="none") %>%
group_by(county) %>%
count(injury) %>%
summarize(tot_inj=sum(n)) %>%
ggplot(aes(x=county, fill=injury))+
geom_col(position = "dodge")+
coord_flip()+
labs(title = "Total Number of Incidents by County",
x="County",
y="Total Injuries")+
theme(plot.title = element_text(size=rel(1.5), hjust=0.5))
sharks %>%
filter(injury!="none") %>%
ggplot(aes(x=county, fill=injury))+
geom_col(position = "dodge")+
coord_flip()+
labs(title = "Total Number of Incidents by County",
x="County",
y="Total Injuries")+
theme(plot.title = element_text(size=rel(1.5), hjust=0.5))
sharks %>%
filter(injury!="none") %>%
ggplot(aes(x=county, y=injury, fill=injury))+
geom_col(position = "dodge")+
coord_flip()+
labs(title = "Total Number of Incidents by County",
x="County",
y="Total Injuries")+
theme(plot.title = element_text(size=rel(1.5), hjust=0.5))
sharks %>%
filter(injury!="none") %>%
ggplot(aes(x=county, y=injury))+
geom_col(position = "dodge")+
coord_flip()+
labs(title = "Total Number of Incidents by County",
x="County",
y="Total Injuries")+
theme(plot.title = element_text(size=rel(1.5), hjust=0.5))
sharks %>%
filter(injury!="none") %>%
group_by(county) %>%
count(injury) %>%
summarize(tot_inj=sum(n)) %>%
ggplot(aes(x=county, y=tot_inj))+
geom_col(position = "dodge")+
coord_flip()+
labs(title = "Total Number of Incidents by County",
x="County",
y="Total Injuries")+
theme(plot.title = element_text(size=rel(1.5), hjust=0.5))
sharks %>%
count(mode) %>%
ggplot(aes(x=mode, y=n))+
geom_col(position="dodge")+
coord_flip()+
labs(title = "Number of Incidents vs. Activity",
x="Activity",
y="Number of Incidents")+
theme(plot.title = element_text(size=rel(1.5), hjust=0.5))
sharks %>%
count(mode) %>%
ggplot(aes(x=mode, y=n))+
geom_col()+
coord_flip()+
labs(title = "Number of Incidents vs. Activity",
x="Activity",
y="Number of Incidents")+
theme(plot.title = element_text(size=rel(1.5), hjust=0.5))
sharks %>%
count(mode) %>%
ggplot(aes(x=mode, y=n, fill=mode))+
geom_col()+
coord_flip()+
labs(title = "Number of Incidents vs. Activity",
x="Activity",
y="Number of Incidents")+
theme(plot.title = element_text(size=rel(1.5), hjust=0.5))
sharks %>%
count(species)
sharks %>%
count(species) %>%
arrange(-n)
View(sharks)
sharks %>%
filter(species=="White")
sharks %>%
filter(species=="White") %>%
count(injury)
sharks %>%
filter(species=="White") %>%
ggplot(aes(x=injury))+
geom_bar()
sharks %>%
filter(species=="White") %>%
ggplot(aes(x=injury))+
geom_bar()+
labs(title = "Number of Incidents vs. Types of Incidents for Great White Sharks",
x="Types of Incidents",
y="Number of Incidents")+
theme(plot.title = element_text(size=rel(1.5), hjust=0.5))
sharks %>%
filter(injury!="none") %>%
group_by(county) %>%
count(injury)
sharks %>%
filter(injury!="none") %>%
group_by(county) %>%
count(injury) %>%
arrange(-n)
sharks %>%
group_by(county) %>%
count(injury) %>%
arrange(-n)
sharks %>%
group_by(county) %>%
count(injury) %>%
summarize(tot_inj=sum(n)) %>%
arrange(-tot_inj)
sharks %>%
group_by(county) %>%
count(injury) %>%
summarize(tot_inj=sum(n)) %>%
ggplot(aes(x=county, y=tot_inj))+
geom_col()+
coord_flip()+
labs(title = "Total Number of Incidents by County",
x="County",
y="Total Injuries")+
theme(plot.title = element_text(size=rel(1.5), hjust=0.5))
