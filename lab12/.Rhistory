library("tidyverse")
library("janitor")
library("naniar")
library("tidyverse")
library("janitor")
library("naniar")
library("tidyverse")
library("janitor")
library("naniar")
sharks <- read_csv("data/SharkIncidents_1950_2022_220302.csv") %>% clean_names()
sharks
miss_var_summary(sharks)
sharks <- sharks %>%
filter(incident_num!="NOT COUNTED")
sharks %>%
count(county) %>%
arrange(-n)
sharks %>%
count(county) %>%
ggplot(aes(x=county, y=n, fill=county))+
geom_col()+
coord_flip()+
labs(title="County vs. Number of incidents",
x="County Names",
y="Number of incidents")+
theme(plot.title = element_text(size=rel(1.5), hjust=0.5))
sharks %>%
count(month) %>%
arrange(-n)
sharks %>%
count(month) %>%
ggplot(aes(x=month, y=n))+
geom_col()+
labs(title = "Number of Incidents vs. Month",
x="Month",
y="Number of Incidents")+
theme(plot.title = element_text(size=rel(1.5), hjust=0.5))
sharks %>%
group_by(county, injury) %>%
summarize(num_inju=n(), .groups="drop") %>%
pivot_wider(names_from = injury, values_from = num_inju) %>%
mutate(total_incidents=rowSums(across(where(is.numeric)), na.rm=T)) %>%
arrange(-total_incidents)
sharks %>%
ggplot(aes(x=county, fill = injury))+
geom_bar()+
coord_flip()+
labs(title = "Total Number of Incidents by County",
x="County",
y="Total Injuries")+
theme(plot.title = element_text(size=rel(1.5), hjust=0.5))
sharks %>%
group_by(county, injury) %>%
summarize(num_inju=n(), .groups="keep") %>%
pivot_wider(names_from = injury, values_from = num_inju) %>%
mutate(total_incidents=rowSums(across(where(is.numeric)), na.rm=T)) %>%
arrange(-total_incidents)
sharks %>%
count(month) %>%
ggplot(aes(x=as_factor(month), y=n))+
geom_col()+
labs(title = "Number of Incidents vs. Month",
x="Month",
y="Number of Incidents")+
theme(plot.title = element_text(size=rel(1.5), hjust=0.5))
sharks %>%
ggplot(aes(x=reorder(county), fill = injury))+
geom_bar()+
coord_flip()+
labs(title = "Total Number of Incidents by County",
x="County",
y="Total Injuries")+
theme(plot.title = element_text(size=rel(1.5), hjust=0.5))
ggplot(aes(x=reorder(county, fill = injury))+
sharks %>%
ggplot(aes(x=reorder(county, fill = injury)))+
geom_bar()+
coord_flip()+
labs(title = "Total Number of Incidents by County",
x="County",
y="Total Injuries")+
theme(plot.title = element_text(size=rel(1.5), hjust=0.5))
sharks %>%
sharks %>%
ggplot(aes(x=reorder(county, fill = injury)))+
geom_bar()+
coord_flip()+
labs(title = "Total Number of Incidents by County",
x="County",
y="Total Injuries")+
theme(plot.title = element_text(size=rel(1.5), hjust=0.5))
sharks %>%
ggplot(aes(x=county, fill = injury))+
geom_bar()+
coord_flip()+
labs(title = "Total Number of Incidents by County",
x="County",
y="Total Injuries")+
theme(plot.title = element_text(size=rel(1.5), hjust=0.5))
sharks %>%
count(county) %>%
ggplot(aes(x=reorder(county, y=n), fill=county))+
geom_col()+
coord_flip()+
labs(title="County vs. Number of incidents",
x="County Names",
y="Number of incidents")+
theme(plot.title = element_text(size=rel(1.5), hjust=0.5))
sharks %>%
count(county) %>%
ggplot(aes(x=reorder(county), y=n, fill=county))+
geom_col()+
coord_flip()+
labs(title="County vs. Number of incidents",
x="County Names",
y="Number of incidents")+
theme(plot.title = element_text(size=rel(1.5), hjust=0.5))
sharks %>%
count(county) %>%
ggplot(aes(reorder(x=county), y=n, fill=county))+
geom_col()+
coord_flip()+
labs(title="County vs. Number of incidents",
x="County Names",
y="Number of incidents")+
theme(plot.title = element_text(size=rel(1.5), hjust=0.5))
sharks %>%
count(county) %>%
ggplot(aes(reorder(x=county, y=n), fill=county))+
geom_col()+
coord_flip()+
labs(title="County vs. Number of incidents",
x="County Names",
y="Number of incidents")+
theme(plot.title = element_text(size=rel(1.5), hjust=0.5))
sharks %>%
count(county) %>%
ggplot(aes(x=reorder(county), y=n, fill=county))+
geom_col()+
coord_flip()+
labs(title="County vs. Number of incidents",
x="County Names",
y="Number of incidents")+
theme(plot.title = element_text(size=rel(1.5), hjust=0.5))
sharks %>%
count(county) %>%
ggplot(aes(x=county, y=n, fill=county))+
geom_col()+
coord_flip()+
labs(title="County vs. Number of incidents",
x="County Names",
y="Number of incidents")+
theme(plot.title = element_text(size=rel(1.5), hjust=0.5))
library(tidyverse)
library(janitor)
options(scipen=999) #cancels the use of scientific notation for the session
deserts <- read_csv("data/surveys_complete.csv")
homerange <- read_csv("data/Tamburelloetal_HomeRangeDatabase.csv", na = c("", "NA", "\\", "-999"))
homerange %>%
ggplot(aes(x=taxon, y=log10.mass))+
geom_boxplot()
homerange %>%
ggplot(aes(x=taxon, y=log10.mass), fill=taxon)+
geom_boxplot()
homerange %>%
ggplot(aes(x=taxon, y=log10.mass,  fill=taxon))+
geom_boxplot()
homerange %>%
ggplot(aes(x=taxon, y=log10.mass,  fill=taxon))+
geom_boxplot()
homerange %>%
ggplot(aes(x=taxon, y=log10.mass))+
geom_boxplot()
homerange %>%
ggplot(aes(x=taxon, y=log10.mass))+
geom_boxplot()+
labs(fill=taxon)
homerange %>%
ggplot(aes(x=taxon, y=log10.mass))+
geom_boxplot()+
labs(fill=x)
homerange %>%
ggplot(aes(x=taxon, y=log10.mass))+
geom_boxplot()+
labs(fill(taxon))
homerange %>%
ggplot(aes(x=taxon, y=log10.mass, fill=taxon))+
geom_boxplot()
homerange %>%
ggplot(aes(x=taxon, y=log10.mass,  fill=taxon))+
geom_boxplot()
homerange %>%
ggplot(aes(x=taxon, y=log10.mass, fill=class))+
geom_boxplot()
homerange %>%
ggplot(aes(x=class, y=log10.mass))+
geom_boxplot()
homerange %>%
ggplot(aes(x=class, y=log10.mass, fill=class))+
geom_boxplot()
homerange %>%
ggplot(aes(x=class, y=log10.mass,  fill=taxon))+
geom_boxplot()
deserts %>%
filter(species_id=="DM")
deserts %>%
filter(species_id=="DM"| species_id=="DS")
deserts %>%
filter(species_id=="DM"| species_id=="DS") %>%
mutate(year=as.factor(year))
deserts %>%
filter(species_id=="DM"| species_id=="DS") %>%
mutate(year=as.factor(year)) %>%
group_by(year, species_id) %>%
summarize(n=n(), .groups = "keep")
deserts %>%
filter(species_id=="DM"| species_id=="DS") %>%
mutate(year=as.factor(year)) %>%
group_by(year, species_id) %>%
summarize(n=n(), .groups = "keep") %>%
pivot_wider(names_from = species_id,
values_from = n)
speciesdmds <- deserts %>%
filter(species_id=="DM"| species_id=="DS") %>%
mutate(year=as.factor(year)) %>%
group_by(year, species_id) %>%
summarize(n=n(), .groups = "keep") %>%
pivot_wider(names_from = species_id,
values_from = n)
speciesdmds %>%
ggplot(aes(x=year, y=n, group = species_id, color=species_id))+
geom_line()
speciesdmds %>%
ggplot(aes(x=year, y=n, group = species_id, color=species_id))+
geom_line()+
geom_point()
deserts %>%
filter(species_id=="DM"| species_id=="DS") %>%
mutate(year=as.factor(year)) %>%
group_by(year, species_id) %>%
summarize(n=n(), .groups = "keep")
ggplot(aes(x=year, y=n, group = species_id, color=species_id))+
geom_line()+
geom_point()
deserts %>%
filter(species_id=="DM"| species_id=="DS") %>%
mutate(year=as.factor(year)) %>%
group_by(year, species_id) %>%
summarize(n=n(), .groups = "keep") %>%
pivot_wider(names_from = species_id,
values_from = n)
deserts %>%
filter(species_id=="DM"| species_id=="DS") %>%
mutate(year=as.factor(year)) %>%
group_by(year, species_id) %>%
summarize(n=n(), .groups = "keep")
ggplot(aes(x=year, y=n, group = species_id, color=species_id))+
geom_line()+
geom_point()
deserts %>%
filter(species_id=="DM"| species_id=="DS") %>%
mutate(year=as.factor(year)) %>%
group_by(year, species_id) %>%
summarize(n=n(), .groups = "keep") %>%
pivot_wider(names_from = species_id,
values_from = n)
deserts %>%
filter(species_id=="DM"| species_id=="DS") %>%
mutate(year=as.factor(year)) %>%
group_by(year, species_id) %>%
summarize(n=n(), .groups = "keep") %>%
ggplot(aes(x=year, y=n, group = species_id, color=species_id))+
geom_line()+
geom_point()
deserts %>%
filter(species_id=="DM"| species_id=="DS") %>%
mutate(year=as.factor(year)) %>%
group_by(year, species_id) %>%
summarize(n=n(), .groups = "keep") %>%
ggplot(aes(x=year, y=n, group = species_id, color=species_id))+ # if no group=species_id, no line!
geom_line()+
geom_point()+
theme(axis.text.x = element_text(angle = 60, hjust = 1))
deserts %>%
filter(species_id=="DM"| species_id=="DS") %>%
mutate(year=as.factor(year)) %>%
group_by(year, species_id) %>%
summarize(n=n(), .groups = "keep") %>%
ggplot(aes(x=year, y=n, group = species_id, color=species_id))+ # if no group=species_id, no line!
geom_line()+
geom_point(shape=5)+ # without geom_points, remove the dots, only line is left
theme(axis.text.x = element_text(angle = 60, hjust = 1))
homerange %>%
ggplot(aes(log10.mass))+
geom_histogram()
homerange %>%
ggplot(aes(log10.mass))+
geom_histogram(bins=50)
homerange %>%
ggplot(aes(log10.mass))+
geom_histogram(bins=10) # control distribution looks
homerange %>%
ggplot(aes(log10.mass))+
geom_histogram(bins=70) # control distribution looks
colors()
#colors()
homerange %>%
ggplot(aes(log10.mass))+
geom_histogram(color="black", fill="azure")
homerange %>%
ggplot(aes(log10.mass))+
geom_histogram(color="violet", fill="azure") #color==the outerline of the bars; fill== the fill color of the bars itself
homerange %>%
ggplot(aes(log10.mass))+
geom_density(fill="deepskyblue", color="black")
colors()
#colors()
```
homerange %>%
ggplot(aes(log10.mass))+
geom_density(fill="deepskyblue", color="black", alpha=0.4) # geom_density is histogram but smoother
homerange %>%
ggplot(aes(log10.mass))+
geom_density(fill="deepskyblue3", color="black", alpha=0.4) # geom_density is histogram but smoother
homerange %>%
ggplot(aes(x=log10.mass)) +
geom_histogram(aes(y = after_stat(density)), fill = "deepskyblue4", alpha = 0.4, color = "black")+
geom_density(color = "red")+
labs(title = "Distribution of Body Mass")
homerange %>%
ggplot(aes(x=log10.hra))+
geom_histogram()
homerange %>%
ggplot(aes(x=log10.hra))+
geom_histogram() +
labs(title = "log10.hra Histogram",
x="log10.hra",
y="Value")
homerange %>%
ggplot(aes(x=log10.hra))+
geom_histogram() +
labs(title = "log10.hra Histogram",
x="log10.hra",
y="Value")
homerange %>%
ggplot(aes(x=log10.hra)) +
geom_histogram(aes(y = after_stat(density)), fill = "deepskyblue4", alpha = 0.4, color = "black")+ #after_stat allow overlying the density plot on top of the histogram
geom_density(color = "red")+ # best to make the colors stay consistent
labs(title = "Distribution of Body Mass")
homerange %>%
ggplot(aes(x=log10.mass)) +
geom_histogram()+ #after_stat allow overlying the density plot on top of the histogram
geom_density(color = "red")+ # best to make the colors stay consistent
labs(title = "Distribution of Body Mass")
homerange %>%
ggplot(aes(x=log10.mass)) +
geom_density(fill= "cyan4", color = "red")+ # best to make the colors stay consistent
labs(title = "Distribution of Body Mass")
homerange %>%
ggplot(aes(x=log10.mass)) +
geom_density(fill= "cyan4", color = "red")+ # best to make the colors stay consistent
labs(title = "Distribution of Homerange")
homerange %>%
ggplot(aes(x=log10.hra))+
geom_histogram(fill="cyan4", color="red") +
labs(title = "log10.hra Histogram",
x="log10.hra",
y="Value")
homerange %>%
ggplot(aes(x=log10.hra)) +
geom_histogram(aes(y = after_stat(density)), fill = "cyan4", alpha = 0.4, color = "black")+ #after_stat allow overlying the density plot on top of the histogram
geom_density(color = "red")+ # best to make the colors stay consistent
labs(title = "Distribution of Homerange")
homerange %>%
ggplot(aes(x=log10.mass)) +
geom_density(fill= "cyan4", color = "black")+ # best to make the colors stay consistent
labs(title = "Distribution of Homerange")
homerange %>%
ggplot(aes(x=log10.hra))+
geom_histogram(fill="cyan4", color="black") +
labs(title = "log10.hra Histogram",
x="log10.hra",
y="Value")
glimpse(homerange)
summary(homerange$log10.mass)
install.packages("gtools")
#install.packages("gtools")
library(gtools)
quartiles <- quantcut(homerange$log10.mass)
table(quartiles)
homerange %>%
mutate(mass_category=case_when(log10.mass<=1.7))
homerange %>%
mutate(mass_category=case_when(log10.mass<=1.7 ~ "small"))
homerange %>%
mutate(mass_category=case_when(log10.mass<=1.7 ~ "small",
log10.mass>1.7 & log10.mass<=3.33 ~ "medium",
log10.mass>3.33 ~ "large")) # when log10.mass is less than or equal to 1.7, put it as "small"
homerange <- homerange %>%
mutate(mass_category=case_when(log10.mass<=1.7 ~ "small", #when log10.mass is less than or equal to 1.7, put it as "small" in mass category
log10.mass>1.7 & log10.mass<=3.33 ~ "medium",
log10.mass>3.33 ~ "large")) # case_when makes continous data to other things
homerange %>%
ggplot(aes(x=mass_category, fill=trophic.guild))+
geom_bar()
homerange %>%
ggplot(aes(x=mass_category, fill=trophic.guild))+
geom_bar(position="dodge")
summary(homerange$log10.hra)
quartiles1 <- quantcut(homerange$log10.hra)
table(quartiles1)
homerange %>%
mutate(range_category=case_when(log10.hra<=3.65 ~ "very small",
log10.hra > 3.65 & log10.hra <=4.59 ~ "small",
log10.hra > 4.49 & log10.hra <= 6.02 ~ "medium",
log10.hra > 6.02 ~ "large"))
homerange <- homerange %>%
mutate(range_category=case_when(log10.hra<=3.65 ~ "very small",
log10.hra > 3.65 & log10.hra <=4.59 ~ "small",
log10.hra > 4.49 & log10.hra <= 6.02 ~ "medium",
log10.hra > 6.02 ~ "large"))
homerange %>%
ggplot(aes(x=range_category, fill = class))+
geom_bar()
homerange %>%
ggplot(aes(x=range_category, fill = class))+
geom_bar(position = "dodge")
homerange %>%
filter(range_category=="small")
homerange %>%
filter(range_category=="small") %>%
ggplot(aes(x=log10.mass, y=class))+
geom_boxplot()
homerange %>%
filter(range_category=="small") %>%
ggplot(aes(x=log10.mass, fill=class))+
geom_boxplot()
homerange %>%
filter(range_category=="small") %>%
ggplot(aes(x=log10.mass, fill=class))+
geom_boxplot(position = "dodge")
homerange %>%
filter(range_category=="small") %>%
ggplot(aes(x=log10.mass, fill=class))+
geom_bar(position = "dodge")
homerange %>%
filter(range_category=="small") %>%
ggplot(aes(x=range_category, fill = class))+
geom_bar(position = "dodge")
homerange %>%
filter(range_category=="small") %>%
ggplot(aes(x=log10.mass, fill = class))+
geom_bar(position = "dodge")
homerange %>%
filter(range_category=="small") %>%
ggplot(aes(x=log10.mass, fill = class))+
geom_bar(position = "dodge")
homerange %>%
filter(range_category=="small") %>%
ggplot(aes(x=log10.mass, fill = class))+
geom_bar(position = "dodge", alpha=0.4)
knitr::opts_chunk$set(echo = TRUE)
library(tidyverse)
library(janitor)
library(naniar)
options(scipen = 999)
#install.packages("gapminder")
library("gapminder")
#install.packages("gapminder")
library("gapminder")
gapminder
homerange %>%
filter(range_category=="small") %>%
ggplot(aes(x=range_category, fill = class))+
geom_bar(position = "dodge", alpha=0.4)
homerange %>%
filter(range_category=="small") %>%
ggplot(aes(x=range_category, fill = class))+
geom_bar(position = "dodge")
homerange %>%
filter(range_category=="small") %>%
ggplot(aes(x=mass_category, fill = class))+
geom_bar(position = "dodge")
